{"ast":null,"code":"import { clientListActionType } from \"../Action-Types\";\nexport const initialState = {\n  count: 0,\n  active: \"\",\n  list: []\n};\nexport const clientListReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case clientListActionType.ADDCLIENT:\n      {\n        console.log(\"add client\");\n        if (state.list.find(item => item.username === action.payload.username)) return state;else return { ...state,\n          count: state.count + 1,\n          active: state.active,\n          list: [...state.list, action.payload]\n        };\n      }\n\n    case clientListActionType.REMOVECLIENT:\n      {\n        return { ...state,\n          count: state.count - 1,\n          active: state.active,\n          list: state.list.filter(item => item.id !== action.payload.id)\n        };\n      }\n\n    case clientListActionType.ADDMSG:\n      {\n        let index = -1;\n        let newState = state;\n\n        if (action.payload.sender == \"Me\") {\n          index = state.list.findIndex(item => item.username === action.payload.recipient);\n        } else {\n          index = state.list.findIndex(item => item.username === action.payload.sender);\n        }\n\n        console.log(`reducer add msg, index = ${index}`);\n\n        if (index >= 0) {\n          newState.list[index].convers.msg = [...newState.list[index].convers.msg, action.payload];\n          console.log(`reducer index = ${index}`);\n          console.log(`count = ${state.list[index].convers.count}`);\n          return { ...state,\n            count: state.count,\n            active: state.active,\n            list: newState.list\n          }; // newState.list[index].count;\n          // newState.list[index].msg = [...newState.list[index].msg, action.payload];\n          // newState.list[index].count = newState.list[index].count + 1;\n          // return {\n          //   ...state,\n          //   list: newState.list\n          // };\n        } else {\n          console.log(`add msg but client not found`);\n          return state;\n        }\n      }\n\n    case clientListActionType.SETACTIVECONVERS:\n      {\n        console.log('reducer set active convers');\n        return { ...state,\n          count: state.count,\n          active: action.payload,\n          list: state.list\n        };\n      }\n\n    default:\n      return state;\n  }\n}; //  // return {\n//               //   ...state,\n//               //   list: state.list[index].count + 1,\n//               //   list: [...state.msg, action.payload]\n//               // };\n//             }\n//             else\n//             {\n//               console.log(`reducer create msglist`)\n//               let sender = \"\";\n//               if (action.payload.sender == \"Me\")\n//               {\n//                 sender = action.payload.recipient;\n//               }\n//               else\n//               {\n//                 sender = action.payload.sender;\n//               }\n//               const newMsgList: msgList = {\n//                 name: sender,\n//                 count: 1,\n//                 msg: []\n//               }\n//               newMsgList.msg = [...newMsgList.msg, action.payload];\n//               newState.list = [...newState.list, newMsgList];\n//               return {\n//                 ...state,\n//                 list: newState.list,\n//                 count: state.count + 1\n//               };","map":{"version":3,"names":["clientListActionType","initialState","count","active","list","clientListReducer","state","action","type","ADDCLIENT","console","log","find","item","username","payload","REMOVECLIENT","filter","id","ADDMSG","index","newState","sender","findIndex","recipient","convers","msg","SETACTIVECONVERS"],"sources":["/Users/cgangaro/chat-app_Nestjs-React_Redux-Socket.io/fronttest/src/State/Reducers/clientListReducer.tsx"],"sourcesContent":["import { validateInput } from \"../../Utils/logUtils\";\nimport { clientListActionType } from \"../Action-Types\";\nimport { clientListAction } from \"../Actions\";\nimport { ClientList } from \"../type\";\n\nexport const initialState: ClientList = {\n    count: 0,\n    active: \"\",\n    list: []\n  };\n\nexport const clientListReducer = (state: ClientList = initialState, action: clientListAction) => {\n  switch (action.type) {\n    case clientListActionType.ADDCLIENT: {\n      console.log(\"add client\")\n      if (state.list.find(item => item.username === action.payload.username))\n        return state;\n      else\n        return {\n          ...state,\n          count: state.count + 1,\n          active: state.active,\n          list: [...state.list, action.payload]\n        };\n    }\n    case clientListActionType.REMOVECLIENT: {\n      return {\n          ...state,\n          count: state.count - 1,\n          active: state.active,\n          list: state.list.filter(item => item.id !== action.payload.id)\n        };\n    }\n    case clientListActionType.ADDMSG: {\n      let index = -1;\n      let newState = state;\n      if (action.payload.sender == \"Me\")\n      {\n        index = state.list.findIndex(item => item.username === action.payload.recipient);\n      }\n      else\n      {\n        index = state.list.findIndex(item => item.username === action.payload.sender);\n      }\n      console.log(`reducer add msg, index = ${index}`);\n      if (index >= 0)\n      {\n        newState.list[index].convers.msg = [...newState.list[index].convers.msg, action.payload];\n        console.log(`reducer index = ${index}`)\n        console.log(`count = ${state.list[index].convers.count}`)\n        return {\n          ...state,\n          count: state.count,\n          active: state.active,\n          list: newState.list\n        };\n        // newState.list[index].count;\n        // newState.list[index].msg = [...newState.list[index].msg, action.payload];\n        // newState.list[index].count = newState.list[index].count + 1;\n        // return {\n        //   ...state,\n        //   list: newState.list\n        // };\n      }\n      else {\n        console.log(`add msg but client not found`);\n        return state;\n      }\n    }\n    case clientListActionType.SETACTIVECONVERS: {\n      console.log('reducer set active convers');\n      return {\n        ...state,\n        count: state.count,\n        active: action.payload,\n        list: state.list\n      }\n    }\n    default:\n      return state;\n  }\n};\n\n//  // return {\n//               //   ...state,\n//               //   list: state.list[index].count + 1,\n//               //   list: [...state.msg, action.payload]\n//               // };\n//             }\n//             else\n//             {\n//               console.log(`reducer create msglist`)\n//               let sender = \"\";\n//               if (action.payload.sender == \"Me\")\n//               {\n//                 sender = action.payload.recipient;\n//               }\n//               else\n//               {\n//                 sender = action.payload.sender;\n//               }\n//               const newMsgList: msgList = {\n//                 name: sender,\n//                 count: 1,\n//                 msg: []\n//               }\n//               newMsgList.msg = [...newMsgList.msg, action.payload];\n//               newState.list = [...newState.list, newMsgList];\n//               return {\n//                 ...state,\n//                 list: newState.list,\n//                 count: state.count + 1\n//               };\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}