{"ast":null,"code":"var _jsxFileName = \"/Users/cgangaro/chat-app_Nestjs-React_Redux-Socket.io/fronttest/src/Components/Chat.tsx\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport \"./CSS/FriendsList.css\";\nimport \"./CSS/All.css\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { actionCreators } from \"../State\";\nimport { bindActionCreators } from \"redux\";\nimport AffMsg from \"./AffMsg\";\nimport FriendsList from \"./FriendsList\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction Chat() {\n  _s();\n\n  const logData = useSelector(state => state.log);\n  const utilsData = useSelector(state => state.utils);\n  const clientList = useSelector(state => state.clientList);\n  const dispatch = useDispatch();\n  const {\n    addClient,\n    removeClient,\n    addMsg\n  } = bindActionCreators(actionCreators, dispatch);\n  utilsData.socket.removeAllListeners();\n  utilsData.socket.on('friendsList', function (arrClient) {\n    console.log('Friends List received, useEffect()');\n\n    for (var i = 0; i < arrClient.length; i++) {\n      if (arrClient[i].username.length > 0 && arrClient[i].id != logData.id) {\n        console.log(`add client: ${arrClient[i].username}`);\n        let newClient = {\n          username: arrClient[i].username,\n          id: arrClient[i].id,\n          convers: {\n            count: 0,\n            msg: []\n          }\n        };\n        addClient(newClient);\n      }\n    }\n  });\n  utilsData.socket.on('newFriend', function (client) {\n    console.log(`new Friend: ${client.username}, useEffect()`);\n\n    if (client.id != logData.id) {\n      let newClient = {\n        username: client.username,\n        id: client.id,\n        convers: {\n          count: 0,\n          msg: []\n        }\n      };\n      addClient(client);\n    }\n  });\n  utilsData.socket.on('removeFriend', function (client) {\n    console.log('removeFriend, useEffect()');\n    if (client.id != logData.id) removeClient(client);\n  });\n  utilsData.socket.on('msgInputToOtherClient', function (msgToSend) {\n    console.log(msgToSend.sender, 'said: ', msgToSend.text);\n    let newmsg = {\n      sender: msgToSend.sender,\n      text: msgToSend.text,\n      recipient: \"Me\"\n    };\n    addMsg(newmsg);\n  });\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(FriendsList, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(AffMsg, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true);\n}\n\n_s(Chat, \"9LLt2ytez1jH2eyqJNSNIjFUnyo=\", false, function () {\n  return [useSelector, useSelector, useSelector, useDispatch];\n});\n\n_c = Chat;\nexport default Chat;\n\nvar _c;\n\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useDispatch","useSelector","actionCreators","bindActionCreators","AffMsg","FriendsList","Chat","logData","state","log","utilsData","utils","clientList","dispatch","addClient","removeClient","addMsg","socket","removeAllListeners","on","arrClient","console","i","length","username","id","newClient","convers","count","msg","client","msgToSend","sender","text","newmsg","recipient"],"sources":["/Users/cgangaro/chat-app_Nestjs-React_Redux-Socket.io/fronttest/src/Components/Chat.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport \"./CSS/FriendsList.css\"\nimport \"./CSS/All.css\"\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { actionCreators, RootState } from \"../State\";\nimport { bindActionCreators } from \"redux\";\nimport { io } from \"socket.io-client\";\nimport { validateInput } from \"../Utils/logUtils\";\nimport { render } from \"@testing-library/react\";\nimport { Client, msg } from \"../State/type\";\nimport AffMsg from \"./AffMsg\";\nimport FriendsList from \"./FriendsList\";\n\nfunction Chat() {\n    \n    const logData = useSelector((state: RootState) => state.log)\n    const utilsData = useSelector((state: RootState) => state.utils)\n    const clientList = useSelector((state: RootState) => state.clientList)\n\n    const dispatch = useDispatch();\n\n    const { addClient, removeClient, addMsg } = bindActionCreators(actionCreators, dispatch);\n\n    utilsData.socket.removeAllListeners();\n\n    utilsData.socket.on('friendsList', function(arrClient: Client[]) {\n        console.log('Friends List received, useEffect()');\n        for (var i = 0; i < arrClient.length; i++)\n        {\n          if (arrClient[i].username.length > 0 && arrClient[i].id != logData.id)\n          {\n            console.log(`add client: ${arrClient[i].username}`)\n            let newClient: Client = {\n              username: arrClient[i].username,\n              id: arrClient[i].id,\n              convers: {count: 0, msg: []}\n            }\n            addClient(newClient);\n          }\n        }\n      })\n      utilsData.socket.on('newFriend', function(client: Client) {\n        console.log(`new Friend: ${client.username}, useEffect()`);\n        if (client.id != logData.id)\n        {\n          let newClient: Client = {\n            username: client.username,\n            id: client.id,\n            convers: {count: 0, msg: []}\n          }\n          addClient(client);\n        }\n      })\n      utilsData.socket.on('removeFriend', function(client: Client) {\n        console.log('removeFriend, useEffect()');\n        if (client.id != logData.id)\n          removeClient(client);\n      })\n      utilsData.socket.on('msgInputToOtherClient', function(msgToSend: any) {\n        console.log(msgToSend.sender, 'said: ', msgToSend.text);\n        let newmsg: msg = {\n            sender: msgToSend.sender,\n            text: msgToSend.text,\n            recipient: \"Me\"\n        }\n        addMsg(newmsg);\n    })\n  \n\n  return (\n    <>\n    <FriendsList/>\n    <AffMsg/>\n    </>\n  );\n}\n\nexport default Chat;"],"mappings":";;;AAAA,OAAOA,KAAP,MAAmD,OAAnD;AACA,OAAO,uBAAP;AACA,OAAO,eAAP;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,cAAT,QAA0C,UAA1C;AACA,SAASC,kBAAT,QAAmC,OAAnC;AAKA,OAAOC,MAAP,MAAmB,UAAnB;AACA,OAAOC,WAAP,MAAwB,eAAxB;;;;AAEA,SAASC,IAAT,GAAgB;EAAA;;EAEZ,MAAMC,OAAO,GAAGN,WAAW,CAAEO,KAAD,IAAsBA,KAAK,CAACC,GAA7B,CAA3B;EACA,MAAMC,SAAS,GAAGT,WAAW,CAAEO,KAAD,IAAsBA,KAAK,CAACG,KAA7B,CAA7B;EACA,MAAMC,UAAU,GAAGX,WAAW,CAAEO,KAAD,IAAsBA,KAAK,CAACI,UAA7B,CAA9B;EAEA,MAAMC,QAAQ,GAAGb,WAAW,EAA5B;EAEA,MAAM;IAAEc,SAAF;IAAaC,YAAb;IAA2BC;EAA3B,IAAsCb,kBAAkB,CAACD,cAAD,EAAiBW,QAAjB,CAA9D;EAEAH,SAAS,CAACO,MAAV,CAAiBC,kBAAjB;EAEAR,SAAS,CAACO,MAAV,CAAiBE,EAAjB,CAAoB,aAApB,EAAmC,UAASC,SAAT,EAA8B;IAC7DC,OAAO,CAACZ,GAAR,CAAY,oCAAZ;;IACA,KAAK,IAAIa,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,SAAS,CAACG,MAA9B,EAAsCD,CAAC,EAAvC,EACA;MACE,IAAIF,SAAS,CAACE,CAAD,CAAT,CAAaE,QAAb,CAAsBD,MAAtB,GAA+B,CAA/B,IAAoCH,SAAS,CAACE,CAAD,CAAT,CAAaG,EAAb,IAAmBlB,OAAO,CAACkB,EAAnE,EACA;QACEJ,OAAO,CAACZ,GAAR,CAAa,eAAcW,SAAS,CAACE,CAAD,CAAT,CAAaE,QAAS,EAAjD;QACA,IAAIE,SAAiB,GAAG;UACtBF,QAAQ,EAAEJ,SAAS,CAACE,CAAD,CAAT,CAAaE,QADD;UAEtBC,EAAE,EAAEL,SAAS,CAACE,CAAD,CAAT,CAAaG,EAFK;UAGtBE,OAAO,EAAE;YAACC,KAAK,EAAE,CAAR;YAAWC,GAAG,EAAE;UAAhB;QAHa,CAAxB;QAKAf,SAAS,CAACY,SAAD,CAAT;MACD;IACF;EACF,CAfH;EAgBEhB,SAAS,CAACO,MAAV,CAAiBE,EAAjB,CAAoB,WAApB,EAAiC,UAASW,MAAT,EAAyB;IACxDT,OAAO,CAACZ,GAAR,CAAa,eAAcqB,MAAM,CAACN,QAAS,eAA3C;;IACA,IAAIM,MAAM,CAACL,EAAP,IAAalB,OAAO,CAACkB,EAAzB,EACA;MACE,IAAIC,SAAiB,GAAG;QACtBF,QAAQ,EAAEM,MAAM,CAACN,QADK;QAEtBC,EAAE,EAAEK,MAAM,CAACL,EAFW;QAGtBE,OAAO,EAAE;UAACC,KAAK,EAAE,CAAR;UAAWC,GAAG,EAAE;QAAhB;MAHa,CAAxB;MAKAf,SAAS,CAACgB,MAAD,CAAT;IACD;EACF,CAXD;EAYApB,SAAS,CAACO,MAAV,CAAiBE,EAAjB,CAAoB,cAApB,EAAoC,UAASW,MAAT,EAAyB;IAC3DT,OAAO,CAACZ,GAAR,CAAY,2BAAZ;IACA,IAAIqB,MAAM,CAACL,EAAP,IAAalB,OAAO,CAACkB,EAAzB,EACEV,YAAY,CAACe,MAAD,CAAZ;EACH,CAJD;EAKApB,SAAS,CAACO,MAAV,CAAiBE,EAAjB,CAAoB,uBAApB,EAA6C,UAASY,SAAT,EAAyB;IACpEV,OAAO,CAACZ,GAAR,CAAYsB,SAAS,CAACC,MAAtB,EAA8B,QAA9B,EAAwCD,SAAS,CAACE,IAAlD;IACA,IAAIC,MAAW,GAAG;MACdF,MAAM,EAAED,SAAS,CAACC,MADJ;MAEdC,IAAI,EAAEF,SAAS,CAACE,IAFF;MAGdE,SAAS,EAAE;IAHG,CAAlB;IAKAnB,MAAM,CAACkB,MAAD,CAAN;EACH,CARC;EAWJ,oBACE;IAAA,wBACA,QAAC,WAAD;MAAA;MAAA;MAAA;IAAA,QADA,eAEA,QAAC,MAAD;MAAA;MAAA;MAAA;IAAA,QAFA;EAAA,gBADF;AAMD;;GA9DQ5B,I;UAEWL,W,EACEA,W,EACCA,W,EAEFD,W;;;KANZM,I;AAgET,eAAeA,IAAf"},"metadata":{},"sourceType":"module"}